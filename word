--[[
Author: Obnoxious_Ninja
File: word
Purpose: A component in my custom Operating System
Compatibility: Advanced Computers
--]]

os.loadAPI("GUI_API")

slc = 0
titleBarC = 8
titleBarTC = 1
background = 32768
term.setBackgroundColor(background)
term.clear()

GUI_API.drawDesktopWord()

while true do
local event, button, x, y = os.pullEventRaw()
  if slc == 0 then
    if event == "mouse_click" then
      if x >= 2 and x <= 7 and y == 1 and button == 1 then --Start menu
        GUI_API.drawMenuWord()
        slc = 1
		
		elseif x >= 1 and y >=2 and button == 2 then slc = 2
            if x >= 38 then
            contextX = 38
            end
            if y >= 14 then
            contextY = 14
            end
            if x <= 38 then
            contextX = x
            end
            if y <= 14 then
            contextY = y
            end
            GUI_API.drawMenuContext(contextX, contextY)
        else
        GUI_API.drawDesktopWord()
      end
   end
	
   elseif slc == 1 then
    if x >= 1 and x <= 11 and y == 3 and button == 1 then slc = 0 --For Shutdown button
      os.shutdown()
	   
      elseif x >= 1 and x <= 11 and y == 4 and button == 1 then slc = 0 --For Restart button
        os.reboot()
		
	  elseif x >= 1 and x <= 11 and y == 5 and button == 1 then slc = 0 --For the New File button
		print("File name: ")
		term.setCursorPos(1, 11)
		term.setBackgroundColor(8)
		fileName = read()
		
		if fs.exists(fileName) then
		  term.setTextColor(16384)
		  print("That file already exists!")
		  term.setTextColor(1)
		  sleep(1)
		  GUI_API.drawDesktopWord()
		else
	      shell.run("edit", fileName)
		end
		
	  elseif x >= 1 and x <= 11 and y == 6 and button == 1 then slc = 0	--For the Open File button
	    print("File name: ")
		term.setCursorPos(1, 11)
		term.setBackgroundColor(8)
		fileName = read()
		
		if pcall(shell.run(fileName)) then
		  shell.run("edit", fileName)
		else
		  term.setTextColor(16384)
	      print("That file does not exist!")
		  term.setTextColor(1)
		  sleep(1)
		  GUI_API.drawDesktopWord()
		end
		
	  elseif x >= 1 and x <= 11 and y == 7 and button == 1 then slc = 0	--For the Run File button
	    print("File name: ")
		term.setCursorPos(1, 11)
		term.setBackgroundColor(8)
		fileName = read()
		
		if pcall(shell.run(fileName)) then
		  shell.run(fileName)
		else
		  term.setTextColor(16384)
	      print("That file does not exist!")
		  term.setTextColor(1)
		  sleep(1)
		  GUI_API.drawDesktopWord()
		end
		
	  elseif x >= 1 and x <= 11 and y == 8 and button == 1 then slc = 0
	    shell.run("OS.MAIN")
	
      else
        slc = 0
        GUI_API.drawDesktopWord()
    end
	  elseif slc == 2 then
        if x >= contextX and x <= contextX+13 and y == contextY+1 and button == 1 then slc = 0 --Edit GUI
          shell.run("edit", "GUI_API")
          GUI_API.drawDesktop()
		
          elseif x >= contextX and x <= contextX+13 and y == contextY+2 and button == 1 then slc = 0 --Edit Background
            shell.run("paint", ".background")
			GUI_API.drawDesktop()
			
		  elseif x >= contextX and x <= contextX+13 and y == contextY+3 and button == 1 then slc = 0 --Edit icon
            shell.run("paint", ".icons")
			GUI_API.drawDesktop()	
			
		  elseif x >= contextX and x <= contextX+13 and y == contextY+4 and button == 1 then slc = 0 --File Manager
		    shell.run("file")
            GUI_API.drawDesktop()
			
          else slc = 0
            GUI_API.drawDesktop()
      end
  end
end
